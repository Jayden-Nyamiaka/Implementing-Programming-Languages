# 3 "sexpr/lexer.mll"
 

open Lexing
open Loc

type token =
  | TOK_EOF
  | TOK_WHITE
  | TOK_LPAREN of loc
  | TOK_RPAREN of loc
  | TOK_LBRACKET of loc
  | TOK_RBRACKET of loc
  | TOK_INT of loc * int
  | TOK_ID of loc * string
  | TOK_QUOTE of loc

exception Lexer_error of loc * string

let string_of_token = function
  | TOK_EOF         -> "TOK_EOF"
  | TOK_WHITE       -> "TOK_WHITE"
  | TOK_LPAREN _    -> "TOK_LPAREN"
  | TOK_RPAREN _    -> "TOK_RPAREN"
  | TOK_LBRACKET _  -> "TOK_LBRACKET"
  | TOK_RBRACKET _  -> "TOK_RBRACKET"
  | TOK_INT (_, i)  -> "TOK_INT " ^ string_of_int i
  | TOK_ID (_, id)  -> "TOK_ID " ^ id
  | TOK_QUOTE _     -> "TOK_QUOTE"

let string_of_token_loc tok =
  let sol = string_of_loc_short in
    match tok with
      | TOK_EOF         -> "TOK_EOF"
      | TOK_WHITE       -> "TOK_WHITE"
      | TOK_LPAREN l    -> "TOK_LPAREN   (" ^ sol l ^ ")"
      | TOK_RPAREN l    -> "TOK_RPAREN   (" ^ sol l ^ ")"
      | TOK_LBRACKET l  -> "TOK_LBRACKET   (" ^ sol l ^ ")"
      | TOK_RBRACKET l  -> "TOK_RBRACKET   (" ^ sol l ^ ")"
      | TOK_INT (l, i)  -> Printf.sprintf "TOK_INT %d   (%s)" i (sol l)
      | TOK_ID (l, id)  -> Printf.sprintf "TOK_ID %s   (%s)" id (sol l)
      | TOK_QUOTE l     -> "TOK_QUOTE    (" ^ sol l ^ ")"

let make_loc filename lexbuf =
  get_loc filename (lexeme_start_p lexbuf) (lexeme lexbuf)

let loc_of_token = function
  | TOK_EOF         -> raise (Failure "eof token has no location")
  | TOK_WHITE       -> raise (Failure "whitespace token has no location")
  | TOK_LPAREN l    -> l
  | TOK_RPAREN l    -> l
  | TOK_LBRACKET l  -> l
  | TOK_RBRACKET l  -> l
  | TOK_INT (l, _)  -> l
  | TOK_ID (l, _)   -> l
  | TOK_QUOTE l     -> l


# 60 "sexpr/lexer.ml"
let __ocaml_lex_tables = {
  Lexing.lex_base =
   "\000\000\244\255\092\000\171\000\197\000\247\255\248\255\249\255\
    \250\255\251\255\252\255\002\000\082\000\255\255\254\255\113\000\
    \054\001";
  Lexing.lex_backtrk =
   "\255\255\255\255\010\000\009\000\010\000\255\255\255\255\255\255\
    \255\255\255\255\255\255\002\000\011\000\255\255\255\255\255\255\
    \009\000";
  Lexing.lex_default =
   "\001\000\000\000\255\255\255\255\255\255\000\000\000\000\000\000\
    \000\000\000\000\000\000\255\255\015\000\000\000\000\000\015\000\
    \255\255";
  Lexing.lex_trans =
   "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\011\000\010\000\011\000\000\000\011\000\000\000\011\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \011\000\002\000\011\000\002\000\002\000\002\000\002\000\005\000\
    \009\000\008\000\002\000\004\000\002\000\004\000\002\000\002\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\002\000\012\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\007\000\014\000\006\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\014\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\000\000\000\000\000\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\000\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\000\000\
    \000\000\000\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\000\000\
    \002\000\000\000\002\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\000\000\002\000\000\000\
    \002\000\002\000\002\000\002\000\000\000\000\000\000\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\002\000\
    \013\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \000\000\000\000\000\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \000\000\002\000\000\000\002\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\255\255\000\000\000\000\000\000\000\000\002\000\
    \000\000\002\000\002\000\002\000\002\000\000\000\000\000\000\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \002\000\255\255\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\000\000\000\000\000\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\000\000\002\000\000\000\002\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000";
  Lexing.lex_check =
   "\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\011\000\255\255\000\000\255\255\011\000\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\000\000\011\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\012\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\015\000\000\000\002\000\000\000\002\000\
    \002\000\002\000\002\000\255\255\255\255\255\255\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\255\255\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\255\255\
    \255\255\255\255\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\255\255\
    \002\000\255\255\002\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\255\255\004\000\255\255\
    \004\000\004\000\004\000\004\000\255\255\255\255\255\255\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \000\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \255\255\255\255\255\255\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \255\255\004\000\255\255\004\000\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\012\000\255\255\255\255\255\255\255\255\016\000\
    \255\255\016\000\016\000\016\000\016\000\255\255\255\255\255\255\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\015\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\255\255\255\255\255\255\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\016\000\016\000\016\000\016\000\016\000\016\000\016\000\
    \016\000\255\255\016\000\255\255\016\000\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255";
  Lexing.lex_base_code =
   "";
  Lexing.lex_backtrk_code =
   "";
  Lexing.lex_default_code =
   "";
  Lexing.lex_trans_code =
   "";
  Lexing.lex_check_code =
   "";
  Lexing.lex_code =
   "";
}

let rec lex filename lexbuf =
   __ocaml_lex_lex_rec filename lexbuf 0
and __ocaml_lex_lex_rec filename lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 81 "sexpr/lexer.mll"
                     ( TOK_EOF      )
# 239 "sexpr/lexer.ml"

  | 1 ->
# 82 "sexpr/lexer.mll"
                     ( new_line lexbuf; TOK_WHITE )
# 244 "sexpr/lexer.ml"

  | 2 ->
# 83 "sexpr/lexer.mll"
                     ( TOK_WHITE    )
# 249 "sexpr/lexer.ml"

  | 3 ->
# 84 "sexpr/lexer.mll"
                     ( new_line lexbuf; TOK_WHITE )
# 254 "sexpr/lexer.ml"

  | 4 ->
# 85 "sexpr/lexer.mll"
                     ( TOK_LPAREN   (make_loc filename lexbuf) )
# 259 "sexpr/lexer.ml"

  | 5 ->
# 86 "sexpr/lexer.mll"
                     ( TOK_RPAREN   (make_loc filename lexbuf) )
# 264 "sexpr/lexer.ml"

  | 6 ->
# 87 "sexpr/lexer.mll"
                     ( TOK_LBRACKET (make_loc filename lexbuf) )
# 269 "sexpr/lexer.ml"

  | 7 ->
# 88 "sexpr/lexer.mll"
                     ( TOK_RBRACKET (make_loc filename lexbuf) )
# 274 "sexpr/lexer.ml"

  | 8 ->
# 89 "sexpr/lexer.mll"
                     ( TOK_QUOTE    (make_loc filename lexbuf) )
# 279 "sexpr/lexer.ml"

  | 9 ->
let
# 92 "sexpr/lexer.mll"
               lxm
# 285 "sexpr/lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 92 "sexpr/lexer.mll"
                     ( TOK_INT (make_loc filename lexbuf, int_of_string lxm) )
# 289 "sexpr/lexer.ml"

  | 10 ->
let
# 95 "sexpr/lexer.mll"
                                 lxm
# 295 "sexpr/lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 95 "sexpr/lexer.mll"
                                     ( TOK_ID (make_loc filename lexbuf, lxm) )
# 299 "sexpr/lexer.ml"

  | 11 ->
# 97 "sexpr/lexer.mll"
      (
      raise (Lexer_error (make_loc filename lexbuf, "unrecognized token"))
    )
# 306 "sexpr/lexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf;
      __ocaml_lex_lex_rec filename lexbuf __ocaml_lex_state

;;

# 101 "sexpr/lexer.mll"
 
(* Nothing. *)

# 317 "sexpr/lexer.ml"
